#ddev-generated by ddev-upsun add-on from .upsun/config.yaml
# If you want to edit this file (not recommended) remove the line above.

---
disable_settings_management: true
docroot: web
php_version: "8.5"
additional_hostnames: []
additional_fqdns: []
web_environment:
- PLATFORM_APP_DIR=/app
- PLATFORM_APPLICATION=eyJuYW1lIjoiZHJ1cGFsIiwidHlwZSI6InBocDo4LjUiLCJkaXNrIjoyMDQ4LCJzaXplIjoiUyIsInByZWZsaWdodCI6eyJlbmFibGVkIjp0cnVlLCJpZ25vcmVkX3J1bGVzIjpbXX19
- PLATFORM_APPLICATION_NAME=drupal
- PLATFORM_BRANCH=dev
- PLATFORM_DOCUMENT_ROOT=/var/www/html/web
- PLATFORM_ENVIRONMENT_TYPE=development
- PLATFORM_PROJECT_ENTROPY=342b24bbab171ed99d0c3f6cb38850b87c86be6a3b5078a3057c7df14c0b32f1
- PLATFORM_ROUTES=eyJodHRwczpcL1wvZHAuZGRldi5zaXRlXC8iOnsiYXR0cmlidXRlcyI6e30sImlkIjpudWxsLCJvcmlnaW5hbF91cmwiOiJodHRwczpcL1wve2FsbH1cLyIsInByaW1hcnkiOnRydWUsInByb2R1Y3Rpb25fdXJsIjoiaHR0cHM6XC9cL2RwLmRkZXYuc2l0ZVwvIiwidHlwZSI6InVwc3RyZWFtIiwidXBzdHJlYW0iOiJkcnVwYWwifX0=
- PLATFORM_VARIABLES=W10=
- PLATFORM_SMTP_HOST=localhost:1025
- PLATFORM_CACHE_DIR=/mnt/ddev-global-cache/ddev-upsun/dp
- PLATFORM_TREE_ID=2c677e46163f3e3fbcb3e196a5ee0ce2ed76f8b0
- REDIS_HOST=redis
- REDIS_PORT=6379
- REDIS_SCHEME=redis
- CACHE_HOST=redis
- CACHE_PORT=6379
- CACHE_SCHEME=redis
- CACHE_URL=redis://redis:6379
- REDIS_URL=redis://redis:6379
webimage_extra_packages:
- php8.5-redis
- php8.5-apcu
- php8.5-gd
hooks:
  pre-start:
  - exec-host: chmod +w ${DDEV_DOCROOT:-web}/sites/default ${DDEV_DOCROOT:-web}/sites/default/settings*php
      2>/dev/null || true
  post-start:
  - exec: chmod +w ${DDEV_DOCROOT:-web}/sites/default ${DDEV_DOCROOT:-web}/sites/default/settings*php
      2>/dev/null || true
  - exec: if [ -f composer.json ] && [ ! -d vendor ]; then composer install --no-dev
      --optimize-autoloader; fi
  - exec: if [ -f vendor/bin/drush ]; then mkdir -p ~/.drush; ln -sf /var/www/html/.drush/drush.yml
      ~/.drush/drush.yml 2>/dev/null || true; fi
  - exec: |
      cd /var/www/html
      set -e
  - exec: |
      cd /var/www/html
      set -e
      if [ -n "$(drush status --field=bootstrap)" ]; then
          drush -y cache-rebuild
          drush -y updatedb
          if [ -n "$(ls $(drush php:eval "echo realpath(Drupal\Core\Site\Settings::get('config_sync_directory'));")/*.yml 2>/dev/null)" ]; then
              drush -y config-import
          else
              echo "No config to import. Skipping."
          fi
      else
          echo "Drupal not installed. Skipping standard Drupal deploy steps"
      fi
  - exec: if [ -f vendor/bin/drush ] && [ -d config/sync ] && [ "$(find config/sync
      -name "*.yml" 2>/dev/null | wc -l)" -gt 0 ]; then cd web && ../vendor/bin/drush
      config:import --yes || true; fi
...
